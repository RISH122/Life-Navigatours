{"id":"luaX","dependencies":[{"name":"C:\\Users\\Rishi\\OneDrive\\Desktop\\4-natours\\starter\\package.json","includedInParent":true,"mtime":1708952721338},{"name":"mongoose","loc":{"line":1,"column":23,"index":23},"parent":"C:\\Users\\Rishi\\OneDrive\\Desktop\\4-natours\\starter\\models\\tourModels.js","resolved":"C:\\Users\\Rishi\\OneDrive\\Desktop\\4-natours\\starter\\node_modules\\mongoose\\dist\\browser.umd.js"},{"name":"slugify","loc":{"line":2,"column":37,"index":74},"parent":"C:\\Users\\Rishi\\OneDrive\\Desktop\\4-natours\\starter\\models\\tourModels.js","resolved":"C:\\Users\\Rishi\\OneDrive\\Desktop\\4-natours\\starter\\node_modules\\slugify\\slugify.js"}],"generated":{"js":"var e=require(\"mongoose\"),t=require(\"slugify\"),r=t.default,i=new e.Schema({name:{type:String,required:[!0,\"A tour must have a name\"],unique:!0,trim:!0,maxlength:[40,\"A tour name must have less or equal then 40 characters\"],minlength:[10,\"A tour name must have more or equal then 10 characters\"]},duration:{type:Number,required:[!0,\"A tour must have a Duration\"]},difficulty:{type:String,required:[!0,\"A tour must have a difficulty\"],enum:{values:[\"easy\",\"medium\",\"difficult\"],message:\"Difficulty is either: easy, medium, difficult\"}},ratingsAverage:{type:Number,default:4.5,min:[1,\"Rating must be above 1.0\"],max:[5,\"Rating must be below 5.0\"],set:function(e){return Math.round(10*e)/10}},ratingsQuantity:{type:Number,default:0},price:{type:Number,required:[!0,\"A tour must have a price\"]},slug:String,priceDiscount:{type:Number,validate:{validator:function(e){return e<this.price},message:\"Discount price ({VALUE}) should be below regular price\"}},summary:{type:String,required:[!0,\"A tour must have a summary\"],trim:!0},description:{type:String,trim:!0},imageCover:{type:String,required:[!0,\"A tour must have imagecover\"]},images:[String],createdAt:{type:Date,default:Date.now(),select:!1},startDates:[Date],secretTour:{type:Boolean,default:!1},startLocation:{type:{type:String,default:\"Point\",enum:[\"Point\"]},coordinates:[Number],address:String,description:String},maxGroupSize:Number,locations:[{type:{type:String,default:\"Point\",enum:[\"Point\"]},coordinates:[Number],address:String,description:String,day:Number}],guides:[{type:e.Schema.ObjectId,ref:\"User\"}]},{toJSON:{virtuals:!0}},{toObject:{virtuals:!0}});i.index({price:1,ratingsAverage:-1}),i.index({slug:1}),i.index({startLocation:\"2dsphere\"}),i.virtual(\"durationWeeks\").get(function(){return this.duration/7}),i.virtual(\"reviews\",{ref:\"Review\",foreignField:\"tour\",localField:\"_id\"}),i.pre(\"save\",function(e){this.slug=r(this.name,{lower:!0}),e()}),i.pre(/^find/,function(e){this.find({secretTour:{$ne:!0}}),this.start=Date.now(),e()}),i.post(/^find/,function(e,t){console.log(\"Query took \".concat(Date.now()-this.start,\" milliseconds!\")),t()}),i.pre(/^find/,function(e){this.populate({path:\"guides\",select:\"-__v -passwordChangedAt\"}),e()});var a=e.model(\"Tour\",i);module.exports=a;"},"sourceMaps":{"js":{"mappings":[{"source":"../../models/tourModels.js","original":{"line":1,"column":0},"generated":{"line":1,"column":0}},{"source":"../../models/tourModels.js","name":"mongoose","original":{"line":1,"column":6},"generated":{"line":1,"column":4}},{"source":"../../models/tourModels.js","name":"require","original":{"line":1,"column":15},"generated":{"line":1,"column":6}},{"source":"../../models/tourModels.js","original":{"line":1,"column":23},"generated":{"line":1,"column":14}},{"source":"../../models/tourModels.js","name":"_require","original":{"line":2,"column":0},"generated":{"line":1,"column":26}},{"source":"../../models/tourModels.js","name":"require","original":{"line":2,"column":29},"generated":{"line":1,"column":28}},{"source":"../../models/tourModels.js","original":{"line":2,"column":37},"generated":{"line":1,"column":36}},{"source":"../../models/tourModels.js","name":"slugify","original":{"line":2,"column":17},"generated":{"line":1,"column":47}},{"source":"../../models/tourModels.js","name":"_require","original":{"line":2,"column":24},"generated":{"line":1,"column":49}},{"source":"../../models/tourModels.js","name":"default","original":{"line":2,"column":8},"generated":{"line":1,"column":51}},{"source":"../../models/tourModels.js","name":"tourSchema","original":{"line":5,"column":6},"generated":{"line":1,"column":59}},{"source":"../../models/tourModels.js","original":{"line":5,"column":18},"generated":{"line":1,"column":61}},{"source":"../../models/tourModels.js","name":"mongoose","original":{"line":5,"column":22},"generated":{"line":1,"column":65}},{"source":"../../models/tourModels.js","name":"Schema","original":{"line":5,"column":31},"generated":{"line":1,"column":67}},{"source":"../../models/tourModels.js","original":{"line":5,"column":38},"generated":{"line":1,"column":74}},{"source":"../../models/tourModels.js","name":"name","original":{"line":6,"column":4},"generated":{"line":1,"column":75}},{"source":"../../models/tourModels.js","original":{"line":7,"column":4},"generated":{"line":1,"column":80}},{"source":"../../models/tourModels.js","name":"type","original":{"line":7,"column":8},"generated":{"line":1,"column":81}},{"source":"../../models/tourModels.js","name":"String","original":{"line":7,"column":13},"generated":{"line":1,"column":86}},{"source":"../../models/tourModels.js","name":"required","original":{"line":8,"column":8},"generated":{"line":1,"column":93}},{"source":"../../models/tourModels.js","original":{"line":8,"column":17},"generated":{"line":1,"column":102}},{"source":"../../models/tourModels.js","original":{"line":8,"column":18},"generated":{"line":1,"column":104}},{"source":"../../models/tourModels.js","original":{"line":8,"column":23},"generated":{"line":1,"column":106}},{"source":"../../models/tourModels.js","name":"unique","original":{"line":9,"column":8},"generated":{"line":1,"column":133}},{"source":"../../models/tourModels.js","original":{"line":9,"column":15},"generated":{"line":1,"column":141}},{"source":"../../models/tourModels.js","name":"trim","original":{"line":10,"column":8},"generated":{"line":1,"column":143}},{"source":"../../models/tourModels.js","original":{"line":10,"column":13},"generated":{"line":1,"column":149}},{"source":"../../models/tourModels.js","name":"maxlength","original":{"line":11,"column":8},"generated":{"line":1,"column":151}},{"source":"../../models/tourModels.js","original":{"line":11,"column":19},"generated":{"line":1,"column":161}},{"source":"../../models/tourModels.js","original":{"line":11,"column":20},"generated":{"line":1,"column":162}},{"source":"../../models/tourModels.js","original":{"line":11,"column":24},"generated":{"line":1,"column":165}},{"source":"../../models/tourModels.js","name":"minlength","original":{"line":12,"column":8},"generated":{"line":1,"column":223}},{"source":"../../models/tourModels.js","original":{"line":12,"column":19},"generated":{"line":1,"column":233}},{"source":"../../models/tourModels.js","original":{"line":12,"column":20},"generated":{"line":1,"column":234}},{"source":"../../models/tourModels.js","original":{"line":12,"column":24},"generated":{"line":1,"column":237}},{"source":"../../models/tourModels.js","name":"duration","original":{"line":15,"column":4},"generated":{"line":1,"column":296}},{"source":"../../models/tourModels.js","original":{"line":15,"column":13},"generated":{"line":1,"column":305}},{"source":"../../models/tourModels.js","name":"type","original":{"line":16,"column":8},"generated":{"line":1,"column":306}},{"source":"../../models/tourModels.js","name":"Number","original":{"line":16,"column":13},"generated":{"line":1,"column":311}},{"source":"../../models/tourModels.js","name":"required","original":{"line":17,"column":8},"generated":{"line":1,"column":318}},{"source":"../../models/tourModels.js","original":{"line":17,"column":17},"generated":{"line":1,"column":327}},{"source":"../../models/tourModels.js","original":{"line":17,"column":18},"generated":{"line":1,"column":329}},{"source":"../../models/tourModels.js","original":{"line":17,"column":23},"generated":{"line":1,"column":331}},{"source":"../../models/tourModels.js","name":"difficulty","original":{"line":19,"column":4},"generated":{"line":1,"column":363}},{"source":"../../models/tourModels.js","original":{"line":19,"column":16},"generated":{"line":1,"column":374}},{"source":"../../models/tourModels.js","name":"type","original":{"line":20,"column":6},"generated":{"line":1,"column":375}},{"source":"../../models/tourModels.js","name":"String","original":{"line":20,"column":12},"generated":{"line":1,"column":380}},{"source":"../../models/tourModels.js","name":"required","original":{"line":21,"column":6},"generated":{"line":1,"column":387}},{"source":"../../models/tourModels.js","original":{"line":21,"column":16},"generated":{"line":1,"column":396}},{"source":"../../models/tourModels.js","original":{"line":21,"column":17},"generated":{"line":1,"column":398}},{"source":"../../models/tourModels.js","original":{"line":21,"column":23},"generated":{"line":1,"column":400}},{"source":"../../models/tourModels.js","name":"enum","original":{"line":22,"column":6},"generated":{"line":1,"column":433}},{"source":"../../models/tourModels.js","original":{"line":22,"column":12},"generated":{"line":1,"column":438}},{"source":"../../models/tourModels.js","name":"values","original":{"line":23,"column":8},"generated":{"line":1,"column":439}},{"source":"../../models/tourModels.js","original":{"line":23,"column":16},"generated":{"line":1,"column":446}},{"source":"../../models/tourModels.js","original":{"line":23,"column":17},"generated":{"line":1,"column":447}},{"source":"../../models/tourModels.js","original":{"line":23,"column":25},"generated":{"line":1,"column":454}},{"source":"../../models/tourModels.js","original":{"line":23,"column":35},"generated":{"line":1,"column":463}},{"source":"../../models/tourModels.js","name":"message","original":{"line":24,"column":8},"generated":{"line":1,"column":476}},{"source":"../../models/tourModels.js","original":{"line":24,"column":17},"generated":{"line":1,"column":484}},{"source":"../../models/tourModels.js","name":"ratingsAverage","original":{"line":27,"column":4},"generated":{"line":1,"column":534}},{"source":"../../models/tourModels.js","original":{"line":28,"column":4},"generated":{"line":1,"column":549}},{"source":"../../models/tourModels.js","name":"type","original":{"line":29,"column":8},"generated":{"line":1,"column":550}},{"source":"../../models/tourModels.js","name":"Number","original":{"line":29,"column":13},"generated":{"line":1,"column":555}},{"source":"../../models/tourModels.js","name":"default","original":{"line":30,"column":8},"generated":{"line":1,"column":562}},{"source":"../../models/tourModels.js","original":{"line":30,"column":16},"generated":{"line":1,"column":570}},{"source":"../../models/tourModels.js","name":"min","original":{"line":31,"column":8},"generated":{"line":1,"column":574}},{"source":"../../models/tourModels.js","original":{"line":31,"column":13},"generated":{"line":1,"column":578}},{"source":"../../models/tourModels.js","original":{"line":31,"column":14},"generated":{"line":1,"column":579}},{"source":"../../models/tourModels.js","original":{"line":31,"column":17},"generated":{"line":1,"column":581}},{"source":"../../models/tourModels.js","name":"max","original":{"line":32,"column":8},"generated":{"line":1,"column":609}},{"source":"../../models/tourModels.js","original":{"line":32,"column":13},"generated":{"line":1,"column":613}},{"source":"../../models/tourModels.js","original":{"line":32,"column":14},"generated":{"line":1,"column":614}},{"source":"../../models/tourModels.js","original":{"line":32,"column":17},"generated":{"line":1,"column":616}},{"source":"../../models/tourModels.js","name":"set","original":{"line":33,"column":8},"generated":{"line":1,"column":644}},{"source":"../../models/tourModels.js","original":{"line":33,"column":12},"generated":{"line":1,"column":648}},{"source":"../../models/tourModels.js","name":"val","original":{"line":33,"column":12},"generated":{"line":1,"column":657}},{"source":"../../models/tourModels.js","original":{"line":33,"column":15},"generated":{"line":1,"column":660}},{"source":"../../models/tourModels.js","name":"Math","original":{"line":33,"column":17},"generated":{"line":1,"column":667}},{"source":"../../models/tourModels.js","name":"round","original":{"line":33,"column":22},"generated":{"line":1,"column":672}},{"source":"../../models/tourModels.js","original":{"line":33,"column":32},"generated":{"line":1,"column":678}},{"source":"../../models/tourModels.js","name":"val","original":{"line":33,"column":28},"generated":{"line":1,"column":681}},{"source":"../../models/tourModels.js","original":{"line":33,"column":36},"generated":{"line":1,"column":684}},{"source":"../../models/tourModels.js","name":"ratingsQuantity","original":{"line":35,"column":4},"generated":{"line":1,"column":689}},{"source":"../../models/tourModels.js","original":{"line":36,"column":4},"generated":{"line":1,"column":705}},{"source":"../../models/tourModels.js","name":"type","original":{"line":37,"column":8},"generated":{"line":1,"column":706}},{"source":"../../models/tourModels.js","name":"Number","original":{"line":37,"column":13},"generated":{"line":1,"column":711}},{"source":"../../models/tourModels.js","name":"default","original":{"line":38,"column":8},"generated":{"line":1,"column":718}},{"source":"../../models/tourModels.js","original":{"line":38,"column":16},"generated":{"line":1,"column":726}},{"source":"../../models/tourModels.js","name":"price","original":{"line":40,"column":4},"generated":{"line":1,"column":729}},{"source":"../../models/tourModels.js","original":{"line":41,"column":4},"generated":{"line":1,"column":735}},{"source":"../../models/tourModels.js","name":"type","original":{"line":42,"column":8},"generated":{"line":1,"column":736}},{"source":"../../models/tourModels.js","name":"Number","original":{"line":42,"column":13},"generated":{"line":1,"column":741}},{"source":"../../models/tourModels.js","name":"required","original":{"line":43,"column":8},"generated":{"line":1,"column":748}},{"source":"../../models/tourModels.js","original":{"line":43,"column":17},"generated":{"line":1,"column":757}},{"source":"../../models/tourModels.js","original":{"line":43,"column":18},"generated":{"line":1,"column":759}},{"source":"../../models/tourModels.js","original":{"line":43,"column":23},"generated":{"line":1,"column":761}},{"source":"../../models/tourModels.js","name":"slug","original":{"line":45,"column":4},"generated":{"line":1,"column":790}},{"source":"../../models/tourModels.js","name":"String","original":{"line":45,"column":9},"generated":{"line":1,"column":795}},{"source":"../../models/tourModels.js","name":"priceDiscount","original":{"line":46,"column":4},"generated":{"line":1,"column":802}},{"source":"../../models/tourModels.js","original":{"line":46,"column":19},"generated":{"line":1,"column":816}},{"source":"../../models/tourModels.js","name":"type","original":{"line":47,"column":6},"generated":{"line":1,"column":817}},{"source":"../../models/tourModels.js","name":"Number","original":{"line":47,"column":12},"generated":{"line":1,"column":822}},{"source":"../../models/tourModels.js","name":"validate","original":{"line":48,"column":6},"generated":{"line":1,"column":829}},{"source":"../../models/tourModels.js","original":{"line":48,"column":16},"generated":{"line":1,"column":838}},{"source":"../../models/tourModels.js","name":"validator","original":{"line":49,"column":8},"generated":{"line":1,"column":839}},{"source":"../../models/tourModels.js","original":{"line":49,"column":19},"generated":{"line":1,"column":849}},{"source":"../../models/tourModels.js","name":"val","original":{"line":49,"column":28},"generated":{"line":1,"column":858}},{"source":"../../models/tourModels.js","original":{"line":51,"column":10},"generated":{"line":1,"column":861}},{"source":"../../models/tourModels.js","name":"val","original":{"line":51,"column":17},"generated":{"line":1,"column":868}},{"source":"../../models/tourModels.js","original":{"line":51,"column":23},"generated":{"line":1,"column":870}},{"source":"../../models/tourModels.js","name":"price","original":{"line":51,"column":28},"generated":{"line":1,"column":875}},{"source":"../../models/tourModels.js","name":"message","original":{"line":53,"column":8},"generated":{"line":1,"column":882}},{"source":"../../models/tourModels.js","original":{"line":53,"column":17},"generated":{"line":1,"column":890}},{"source":"../../models/tourModels.js","name":"summary","original":{"line":56,"column":4},"generated":{"line":1,"column":949}},{"source":"../../models/tourModels.js","original":{"line":56,"column":12},"generated":{"line":1,"column":957}},{"source":"../../models/tourModels.js","name":"type","original":{"line":57,"column":8},"generated":{"line":1,"column":958}},{"source":"../../models/tourModels.js","name":"String","original":{"line":57,"column":13},"generated":{"line":1,"column":963}},{"source":"../../models/tourModels.js","name":"required","original":{"line":58,"column":8},"generated":{"line":1,"column":970}},{"source":"../../models/tourModels.js","original":{"line":58,"column":17},"generated":{"line":1,"column":979}},{"source":"../../models/tourModels.js","original":{"line":58,"column":18},"generated":{"line":1,"column":981}},{"source":"../../models/tourModels.js","original":{"line":58,"column":23},"generated":{"line":1,"column":983}},{"source":"../../models/tourModels.js","name":"trim","original":{"line":59,"column":8},"generated":{"line":1,"column":1013}},{"source":"../../models/tourModels.js","original":{"line":59,"column":13},"generated":{"line":1,"column":1019}},{"source":"../../models/tourModels.js","name":"description","original":{"line":61,"column":4},"generated":{"line":1,"column":1022}},{"source":"../../models/tourModels.js","original":{"line":61,"column":16},"generated":{"line":1,"column":1034}},{"source":"../../models/tourModels.js","name":"type","original":{"line":62,"column":8},"generated":{"line":1,"column":1035}},{"source":"../../models/tourModels.js","name":"String","original":{"line":62,"column":13},"generated":{"line":1,"column":1040}},{"source":"../../models/tourModels.js","name":"trim","original":{"line":63,"column":8},"generated":{"line":1,"column":1047}},{"source":"../../models/tourModels.js","original":{"line":63,"column":13},"generated":{"line":1,"column":1053}},{"source":"../../models/tourModels.js","name":"imageCover","original":{"line":65,"column":4},"generated":{"line":1,"column":1056}},{"source":"../../models/tourModels.js","original":{"line":65,"column":15},"generated":{"line":1,"column":1067}},{"source":"../../models/tourModels.js","name":"type","original":{"line":66,"column":8},"generated":{"line":1,"column":1068}},{"source":"../../models/tourModels.js","name":"String","original":{"line":66,"column":13},"generated":{"line":1,"column":1073}},{"source":"../../models/tourModels.js","name":"required","original":{"line":67,"column":8},"generated":{"line":1,"column":1080}},{"source":"../../models/tourModels.js","original":{"line":67,"column":17},"generated":{"line":1,"column":1089}},{"source":"../../models/tourModels.js","original":{"line":67,"column":18},"generated":{"line":1,"column":1091}},{"source":"../../models/tourModels.js","original":{"line":67,"column":23},"generated":{"line":1,"column":1093}},{"source":"../../models/tourModels.js","name":"images","original":{"line":69,"column":4},"generated":{"line":1,"column":1125}},{"source":"../../models/tourModels.js","original":{"line":69,"column":11},"generated":{"line":1,"column":1132}},{"source":"../../models/tourModels.js","name":"String","original":{"line":69,"column":12},"generated":{"line":1,"column":1133}},{"source":"../../models/tourModels.js","name":"createdAt","original":{"line":70,"column":4},"generated":{"line":1,"column":1141}},{"source":"../../models/tourModels.js","original":{"line":70,"column":14},"generated":{"line":1,"column":1151}},{"source":"../../models/tourModels.js","name":"type","original":{"line":71,"column":8},"generated":{"line":1,"column":1152}},{"source":"../../models/tourModels.js","name":"Date","original":{"line":71,"column":13},"generated":{"line":1,"column":1157}},{"source":"../../models/tourModels.js","name":"default","original":{"line":72,"column":8},"generated":{"line":1,"column":1162}},{"source":"../../models/tourModels.js","name":"Date","original":{"line":72,"column":16},"generated":{"line":1,"column":1170}},{"source":"../../models/tourModels.js","name":"now","original":{"line":72,"column":21},"generated":{"line":1,"column":1175}},{"source":"../../models/tourModels.js","name":"select","original":{"line":73,"column":8},"generated":{"line":1,"column":1181}},{"source":"../../models/tourModels.js","original":{"line":73,"column":15},"generated":{"line":1,"column":1189}},{"source":"../../models/tourModels.js","name":"startDates","original":{"line":75,"column":4},"generated":{"line":1,"column":1192}},{"source":"../../models/tourModels.js","original":{"line":75,"column":15},"generated":{"line":1,"column":1203}},{"source":"../../models/tourModels.js","name":"Date","original":{"line":75,"column":16},"generated":{"line":1,"column":1204}},{"source":"../../models/tourModels.js","name":"secretTour","original":{"line":76,"column":4},"generated":{"line":1,"column":1210}},{"source":"../../models/tourModels.js","original":{"line":76,"column":16},"generated":{"line":1,"column":1221}},{"source":"../../models/tourModels.js","name":"type","original":{"line":77,"column":6},"generated":{"line":1,"column":1222}},{"source":"../../models/tourModels.js","name":"Boolean","original":{"line":77,"column":12},"generated":{"line":1,"column":1227}},{"source":"../../models/tourModels.js","name":"default","original":{"line":78,"column":6},"generated":{"line":1,"column":1235}},{"source":"../../models/tourModels.js","original":{"line":78,"column":15},"generated":{"line":1,"column":1244}},{"source":"../../models/tourModels.js","name":"startLocation","original":{"line":80,"column":4},"generated":{"line":1,"column":1247}},{"source":"../../models/tourModels.js","original":{"line":80,"column":19},"generated":{"line":1,"column":1261}},{"source":"../../models/tourModels.js","name":"type","original":{"line":82,"column":6},"generated":{"line":1,"column":1262}},{"source":"../../models/tourModels.js","original":{"line":82,"column":12},"generated":{"line":1,"column":1267}},{"source":"../../models/tourModels.js","name":"type","original":{"line":83,"column":8},"generated":{"line":1,"column":1268}},{"source":"../../models/tourModels.js","name":"String","original":{"line":83,"column":14},"generated":{"line":1,"column":1273}},{"source":"../../models/tourModels.js","name":"default","original":{"line":84,"column":8},"generated":{"line":1,"column":1280}},{"source":"../../models/tourModels.js","original":{"line":84,"column":17},"generated":{"line":1,"column":1288}},{"source":"../../models/tourModels.js","name":"enum","original":{"line":85,"column":8},"generated":{"line":1,"column":1296}},{"source":"../../models/tourModels.js","original":{"line":85,"column":14},"generated":{"line":1,"column":1301}},{"source":"../../models/tourModels.js","original":{"line":85,"column":15},"generated":{"line":1,"column":1302}},{"source":"../../models/tourModels.js","name":"coordinates","original":{"line":87,"column":6},"generated":{"line":1,"column":1312}},{"source":"../../models/tourModels.js","original":{"line":87,"column":19},"generated":{"line":1,"column":1324}},{"source":"../../models/tourModels.js","name":"Number","original":{"line":87,"column":20},"generated":{"line":1,"column":1325}},{"source":"../../models/tourModels.js","name":"address","original":{"line":88,"column":6},"generated":{"line":1,"column":1333}},{"source":"../../models/tourModels.js","name":"String","original":{"line":88,"column":15},"generated":{"line":1,"column":1341}},{"source":"../../models/tourModels.js","name":"description","original":{"line":89,"column":6},"generated":{"line":1,"column":1348}},{"source":"../../models/tourModels.js","name":"String","original":{"line":89,"column":19},"generated":{"line":1,"column":1360}},{"source":"../../models/tourModels.js","name":"maxGroupSize","original":{"line":91,"column":4},"generated":{"line":1,"column":1368}},{"source":"../../models/tourModels.js","name":"Number","original":{"line":91,"column":17},"generated":{"line":1,"column":1381}},{"source":"../../models/tourModels.js","name":"locations","original":{"line":92,"column":4},"generated":{"line":1,"column":1388}},{"source":"../../models/tourModels.js","original":{"line":92,"column":15},"generated":{"line":1,"column":1398}},{"source":"../../models/tourModels.js","original":{"line":93,"column":6},"generated":{"line":1,"column":1399}},{"source":"../../models/tourModels.js","name":"type","original":{"line":94,"column":8},"generated":{"line":1,"column":1400}},{"source":"../../models/tourModels.js","original":{"line":94,"column":14},"generated":{"line":1,"column":1405}},{"source":"../../models/tourModels.js","name":"type","original":{"line":95,"column":10},"generated":{"line":1,"column":1406}},{"source":"../../models/tourModels.js","name":"String","original":{"line":95,"column":16},"generated":{"line":1,"column":1411}},{"source":"../../models/tourModels.js","name":"default","original":{"line":96,"column":10},"generated":{"line":1,"column":1418}},{"source":"../../models/tourModels.js","original":{"line":96,"column":19},"generated":{"line":1,"column":1426}},{"source":"../../models/tourModels.js","name":"enum","original":{"line":97,"column":10},"generated":{"line":1,"column":1434}},{"source":"../../models/tourModels.js","original":{"line":97,"column":16},"generated":{"line":1,"column":1439}},{"source":"../../models/tourModels.js","original":{"line":97,"column":17},"generated":{"line":1,"column":1440}},{"source":"../../models/tourModels.js","name":"coordinates","original":{"line":99,"column":8},"generated":{"line":1,"column":1450}},{"source":"../../models/tourModels.js","original":{"line":99,"column":21},"generated":{"line":1,"column":1462}},{"source":"../../models/tourModels.js","name":"Number","original":{"line":99,"column":22},"generated":{"line":1,"column":1463}},{"source":"../../models/tourModels.js","name":"address","original":{"line":100,"column":8},"generated":{"line":1,"column":1471}},{"source":"../../models/tourModels.js","name":"String","original":{"line":100,"column":17},"generated":{"line":1,"column":1479}},{"source":"../../models/tourModels.js","name":"description","original":{"line":101,"column":8},"generated":{"line":1,"column":1486}},{"source":"../../models/tourModels.js","name":"String","original":{"line":101,"column":21},"generated":{"line":1,"column":1498}},{"source":"../../models/tourModels.js","name":"day","original":{"line":102,"column":8},"generated":{"line":1,"column":1505}},{"source":"../../models/tourModels.js","name":"Number","original":{"line":102,"column":13},"generated":{"line":1,"column":1509}},{"source":"../../models/tourModels.js","name":"guides","original":{"line":105,"column":4},"generated":{"line":1,"column":1518}},{"source":"../../models/tourModels.js","original":{"line":105,"column":11},"generated":{"line":1,"column":1525}},{"source":"../../models/tourModels.js","original":{"line":106,"column":6},"generated":{"line":1,"column":1526}},{"source":"../../models/tourModels.js","name":"type","original":{"line":107,"column":8},"generated":{"line":1,"column":1527}},{"source":"../../models/tourModels.js","name":"mongoose","original":{"line":107,"column":13},"generated":{"line":1,"column":1532}},{"source":"../../models/tourModels.js","name":"Schema","original":{"line":107,"column":22},"generated":{"line":1,"column":1534}},{"source":"../../models/tourModels.js","name":"ObjectId","original":{"line":107,"column":29},"generated":{"line":1,"column":1541}},{"source":"../../models/tourModels.js","name":"ref","original":{"line":108,"column":8},"generated":{"line":1,"column":1550}},{"source":"../../models/tourModels.js","original":{"line":108,"column":12},"generated":{"line":1,"column":1554}},{"source":"../../models/tourModels.js","original":{"line":112,"column":2},"generated":{"line":1,"column":1564}},{"source":"../../models/tourModels.js","name":"toJSON","original":{"line":112,"column":3},"generated":{"line":1,"column":1565}},{"source":"../../models/tourModels.js","original":{"line":112,"column":10},"generated":{"line":1,"column":1572}},{"source":"../../models/tourModels.js","name":"virtuals","original":{"line":112,"column":11},"generated":{"line":1,"column":1573}},{"source":"../../models/tourModels.js","original":{"line":112,"column":20},"generated":{"line":1,"column":1583}},{"source":"../../models/tourModels.js","original":{"line":113,"column":2},"generated":{"line":1,"column":1587}},{"source":"../../models/tourModels.js","name":"toObject","original":{"line":113,"column":3},"generated":{"line":1,"column":1588}},{"source":"../../models/tourModels.js","original":{"line":113,"column":12},"generated":{"line":1,"column":1597}},{"source":"../../models/tourModels.js","name":"virtuals","original":{"line":113,"column":13},"generated":{"line":1,"column":1598}},{"source":"../../models/tourModels.js","original":{"line":113,"column":22},"generated":{"line":1,"column":1608}},{"source":"../../models/tourModels.js","name":"tourSchema","original":{"line":116,"column":2},"generated":{"line":1,"column":1613}},{"source":"../../models/tourModels.js","name":"index","original":{"line":116,"column":13},"generated":{"line":1,"column":1615}},{"source":"../../models/tourModels.js","original":{"line":116,"column":19},"generated":{"line":1,"column":1621}},{"source":"../../models/tourModels.js","name":"price","original":{"line":116,"column":20},"generated":{"line":1,"column":1622}},{"source":"../../models/tourModels.js","original":{"line":116,"column":26},"generated":{"line":1,"column":1628}},{"source":"../../models/tourModels.js","name":"ratingsAverage","original":{"line":116,"column":28},"generated":{"line":1,"column":1630}},{"source":"../../models/tourModels.js","original":{"line":116,"column":44},"generated":{"line":1,"column":1646}},{"source":"../../models/tourModels.js","name":"tourSchema","original":{"line":117,"column":2},"generated":{"line":1,"column":1650}},{"source":"../../models/tourModels.js","name":"index","original":{"line":117,"column":13},"generated":{"line":1,"column":1652}},{"source":"../../models/tourModels.js","original":{"line":117,"column":19},"generated":{"line":1,"column":1658}},{"source":"../../models/tourModels.js","name":"slug","original":{"line":117,"column":20},"generated":{"line":1,"column":1659}},{"source":"../../models/tourModels.js","original":{"line":117,"column":25},"generated":{"line":1,"column":1664}},{"source":"../../models/tourModels.js","name":"tourSchema","original":{"line":118,"column":2},"generated":{"line":1,"column":1668}},{"source":"../../models/tourModels.js","name":"index","original":{"line":118,"column":13},"generated":{"line":1,"column":1670}},{"source":"../../models/tourModels.js","original":{"line":118,"column":19},"generated":{"line":1,"column":1676}},{"source":"../../models/tourModels.js","name":"startLocation","original":{"line":118,"column":20},"generated":{"line":1,"column":1677}},{"source":"../../models/tourModels.js","original":{"line":118,"column":34},"generated":{"line":1,"column":1691}},{"source":"../../models/tourModels.js","name":"tourSchema","original":{"line":119,"column":2},"generated":{"line":1,"column":1704}},{"source":"../../models/tourModels.js","name":"virtual","original":{"line":119,"column":13},"generated":{"line":1,"column":1706}},{"source":"../../models/tourModels.js","original":{"line":119,"column":21},"generated":{"line":1,"column":1714}},{"source":"../../models/tourModels.js","name":"get","original":{"line":119,"column":38},"generated":{"line":1,"column":1731}},{"source":"../../models/tourModels.js","original":{"line":119,"column":42},"generated":{"line":1,"column":1735}},{"source":"../../models/tourModels.js","original":{"line":120,"column":4},"generated":{"line":1,"column":1746}},{"source":"../../models/tourModels.js","original":{"line":120,"column":11},"generated":{"line":1,"column":1753}},{"source":"../../models/tourModels.js","name":"duration","original":{"line":120,"column":16},"generated":{"line":1,"column":1758}},{"source":"../../models/tourModels.js","original":{"line":120,"column":25},"generated":{"line":1,"column":1767}},{"source":"../../models/tourModels.js","name":"tourSchema","original":{"line":123,"column":2},"generated":{"line":1,"column":1771}},{"source":"../../models/tourModels.js","name":"virtual","original":{"line":123,"column":13},"generated":{"line":1,"column":1773}},{"source":"../../models/tourModels.js","original":{"line":123,"column":21},"generated":{"line":1,"column":1781}},{"source":"../../models/tourModels.js","original":{"line":123,"column":31},"generated":{"line":1,"column":1791}},{"source":"../../models/tourModels.js","name":"ref","original":{"line":124,"column":4},"generated":{"line":1,"column":1792}},{"source":"../../models/tourModels.js","original":{"line":124,"column":8},"generated":{"line":1,"column":1796}},{"source":"../../models/tourModels.js","name":"foreignField","original":{"line":125,"column":4},"generated":{"line":1,"column":1805}},{"source":"../../models/tourModels.js","original":{"line":125,"column":17},"generated":{"line":1,"column":1818}},{"source":"../../models/tourModels.js","name":"localField","original":{"line":126,"column":4},"generated":{"line":1,"column":1825}},{"source":"../../models/tourModels.js","original":{"line":126,"column":15},"generated":{"line":1,"column":1836}},{"source":"../../models/tourModels.js","name":"tourSchema","original":{"line":130,"column":0},"generated":{"line":1,"column":1844}},{"source":"../../models/tourModels.js","name":"pre","original":{"line":130,"column":11},"generated":{"line":1,"column":1846}},{"source":"../../models/tourModels.js","original":{"line":130,"column":15},"generated":{"line":1,"column":1850}},{"source":"../../models/tourModels.js","original":{"line":130,"column":23},"generated":{"line":1,"column":1857}},{"source":"../../models/tourModels.js","name":"next","original":{"line":130,"column":32},"generated":{"line":1,"column":1866}},{"source":"../../models/tourModels.js","original":{"line":131,"column":4},"generated":{"line":1,"column":1869}},{"source":"../../models/tourModels.js","name":"slug","original":{"line":131,"column":9},"generated":{"line":1,"column":1874}},{"source":"../../models/tourModels.js","name":"slugify","original":{"line":131,"column":16},"generated":{"line":1,"column":1879}},{"source":"../../models/tourModels.js","original":{"line":131,"column":24},"generated":{"line":1,"column":1881}},{"source":"../../models/tourModels.js","name":"name","original":{"line":131,"column":29},"generated":{"line":1,"column":1886}},{"source":"../../models/tourModels.js","original":{"line":131,"column":35},"generated":{"line":1,"column":1891}},{"source":"../../models/tourModels.js","name":"lower","original":{"line":131,"column":37},"generated":{"line":1,"column":1892}},{"source":"../../models/tourModels.js","original":{"line":131,"column":44},"generated":{"line":1,"column":1899}},{"source":"../../models/tourModels.js","name":"next","original":{"line":132,"column":4},"generated":{"line":1,"column":1903}},{"source":"../../models/tourModels.js","name":"tourSchema","original":{"line":147,"column":2},"generated":{"line":1,"column":1909}},{"source":"../../models/tourModels.js","name":"pre","original":{"line":147,"column":13},"generated":{"line":1,"column":1911}},{"source":"../../models/tourModels.js","original":{"line":147,"column":17},"generated":{"line":1,"column":1915}},{"source":"../../models/tourModels.js","original":{"line":147,"column":26},"generated":{"line":1,"column":1923}},{"source":"../../models/tourModels.js","name":"next","original":{"line":147,"column":35},"generated":{"line":1,"column":1932}},{"source":"../../models/tourModels.js","original":{"line":148,"column":4},"generated":{"line":1,"column":1935}},{"source":"../../models/tourModels.js","name":"find","original":{"line":148,"column":9},"generated":{"line":1,"column":1940}},{"source":"../../models/tourModels.js","original":{"line":148,"column":14},"generated":{"line":1,"column":1945}},{"source":"../../models/tourModels.js","name":"secretTour","original":{"line":148,"column":16},"generated":{"line":1,"column":1946}},{"source":"../../models/tourModels.js","original":{"line":148,"column":28},"generated":{"line":1,"column":1957}},{"source":"../../models/tourModels.js","name":"$ne","original":{"line":148,"column":30},"generated":{"line":1,"column":1958}},{"source":"../../models/tourModels.js","original":{"line":148,"column":35},"generated":{"line":1,"column":1963}},{"source":"../../models/tourModels.js","original":{"line":150,"column":4},"generated":{"line":1,"column":1968}},{"source":"../../models/tourModels.js","name":"start","original":{"line":150,"column":9},"generated":{"line":1,"column":1973}},{"source":"../../models/tourModels.js","name":"Date","original":{"line":150,"column":17},"generated":{"line":1,"column":1979}},{"source":"../../models/tourModels.js","name":"now","original":{"line":150,"column":22},"generated":{"line":1,"column":1984}},{"source":"../../models/tourModels.js","name":"next","original":{"line":151,"column":4},"generated":{"line":1,"column":1990}},{"source":"../../models/tourModels.js","name":"tourSchema","original":{"line":154,"column":2},"generated":{"line":1,"column":1996}},{"source":"../../models/tourModels.js","name":"post","original":{"line":154,"column":13},"generated":{"line":1,"column":1998}},{"source":"../../models/tourModels.js","original":{"line":154,"column":18},"generated":{"line":1,"column":2003}},{"source":"../../models/tourModels.js","original":{"line":154,"column":27},"generated":{"line":1,"column":2011}},{"source":"../../models/tourModels.js","name":"docs","original":{"line":154,"column":36},"generated":{"line":1,"column":2020}},{"source":"../../models/tourModels.js","name":"next","original":{"line":154,"column":42},"generated":{"line":1,"column":2022}},{"source":"../../models/tourModels.js","name":"console","original":{"line":155,"column":4},"generated":{"line":1,"column":2025}},{"source":"../../models/tourModels.js","name":"log","original":{"line":155,"column":12},"generated":{"line":1,"column":2033}},{"source":"../../models/tourModels.js","name":"concat","original":{"line":155,"column":15},"generated":{"line":1,"column":2037}},{"source":"../../models/tourModels.js","name":"concat","original":{"line":155,"column":15},"generated":{"line":1,"column":2051}},{"source":"../../models/tourModels.js","name":"Date","original":{"line":155,"column":30},"generated":{"line":1,"column":2058}},{"source":"../../models/tourModels.js","name":"now","original":{"line":155,"column":35},"generated":{"line":1,"column":2063}},{"source":"../../models/tourModels.js","original":{"line":155,"column":43},"generated":{"line":1,"column":2069}},{"source":"../../models/tourModels.js","name":"start","original":{"line":155,"column":48},"generated":{"line":1,"column":2074}},{"source":"../../models/tourModels.js","original":{"line":155,"column":69},"generated":{"line":1,"column":2080}},{"source":"../../models/tourModels.js","name":"next","original":{"line":156,"column":4},"generated":{"line":1,"column":2099}},{"source":"../../models/tourModels.js","name":"tourSchema","original":{"line":159,"column":2},"generated":{"line":1,"column":2105}},{"source":"../../models/tourModels.js","name":"pre","original":{"line":159,"column":13},"generated":{"line":1,"column":2107}},{"source":"../../models/tourModels.js","original":{"line":159,"column":17},"generated":{"line":1,"column":2111}},{"source":"../../models/tourModels.js","original":{"line":159,"column":26},"generated":{"line":1,"column":2119}},{"source":"../../models/tourModels.js","name":"next","original":{"line":159,"column":35},"generated":{"line":1,"column":2128}},{"source":"../../models/tourModels.js","original":{"line":160,"column":4},"generated":{"line":1,"column":2131}},{"source":"../../models/tourModels.js","name":"populate","original":{"line":160,"column":9},"generated":{"line":1,"column":2136}},{"source":"../../models/tourModels.js","original":{"line":160,"column":18},"generated":{"line":1,"column":2145}},{"source":"../../models/tourModels.js","name":"path","original":{"line":161,"column":6},"generated":{"line":1,"column":2146}},{"source":"../../models/tourModels.js","original":{"line":161,"column":12},"generated":{"line":1,"column":2151}},{"source":"../../models/tourModels.js","name":"select","original":{"line":162,"column":6},"generated":{"line":1,"column":2160}},{"source":"../../models/tourModels.js","original":{"line":162,"column":14},"generated":{"line":1,"column":2167}},{"source":"../../models/tourModels.js","name":"next","original":{"line":165,"column":4},"generated":{"line":1,"column":2195}},{"source":"../../models/tourModels.js","original":{"line":176,"column":2},"generated":{"line":1,"column":2201}},{"source":"../../models/tourModels.js","name":"Tour","original":{"line":176,"column":8},"generated":{"line":1,"column":2205}},{"source":"../../models/tourModels.js","name":"mongoose","original":{"line":176,"column":13},"generated":{"line":1,"column":2207}},{"source":"../../models/tourModels.js","name":"model","original":{"line":176,"column":22},"generated":{"line":1,"column":2209}},{"source":"../../models/tourModels.js","original":{"line":176,"column":28},"generated":{"line":1,"column":2215}},{"source":"../../models/tourModels.js","name":"tourSchema","original":{"line":176,"column":35},"generated":{"line":1,"column":2222}},{"source":"../../models/tourModels.js","name":"module","original":{"line":178,"column":2},"generated":{"line":1,"column":2225}},{"source":"../../models/tourModels.js","name":"exports","original":{"line":178,"column":9},"generated":{"line":1,"column":2232}},{"source":"../../models/tourModels.js","name":"Tour","original":{"line":178,"column":17},"generated":{"line":1,"column":2240}}],"sources":{"../../models/tourModels.js":"const mongoose=require('mongoose');\r\nconst { default: slugify } = require('slugify');\r\n// const validator = require('validator');\r\n\r\nconst tourSchema =new mongoose.Schema({\r\n    name:\r\n    {   type:String,\r\n        required:[true,'A tour must have a name'],\r\n        unique:true,\r\n        trim:true,\r\n        maxlength: [40, 'A tour name must have less or equal then 40 characters'],\r\n        minlength: [10, 'A tour name must have more or equal then 10 characters']\r\n        // validate: [validator.isAlpha, 'Tour name must only contain characters']\r\n    },\r\n    duration:{\r\n        type:Number,\r\n        required:[true,'A tour must have a Duration']\r\n    },\r\n    difficulty: {\r\n      type: String,\r\n      required: [true, 'A tour must have a difficulty'],\r\n      enum: {\r\n        values: ['easy', 'medium', 'difficult'],\r\n        message: 'Difficulty is either: easy, medium, difficult'\r\n      }\r\n    },\r\n    ratingsAverage:\r\n    {\r\n        type:Number,\r\n        default:4.5,\r\n        min: [1, 'Rating must be above 1.0'],\r\n        max: [5, 'Rating must be below 5.0'],\r\n        set:val=>Math.round(val*10)/10\r\n    },\r\n    ratingsQuantity:\r\n    {\r\n        type:Number,\r\n        default:0\r\n    },\r\n    price:\r\n    {\r\n        type:Number,\r\n        required:[true,'A tour must have a price']\r\n    },\r\n    slug:String,\r\n    priceDiscount: {\r\n      type: Number,\r\n      validate: {\r\n        validator: function(val) {\r\n          // this only points to current doc on NEW document creation\r\n          return val < this.price;\r\n        },\r\n        message: 'Discount price ({VALUE}) should be below regular price'\r\n      }\r\n    },\r\n    summary:{\r\n        type:String,\r\n        required:[true,'A tour must have a summary'],\r\n        trim:true\r\n    },\r\n    description:{\r\n        type:String,\r\n        trim:true\r\n    },\r\n    imageCover:{\r\n        type:String,\r\n        required:[true,'A tour must have imagecover']\r\n    },\r\n    images:[String],\r\n    createdAt:{\r\n        type:Date,\r\n        default:Date.now(),\r\n        select:false\r\n    },\r\n    startDates:[Date],\r\n    secretTour: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    startLocation: {\r\n      // GeoJSON\r\n      type: {\r\n        type: String,\r\n        default: 'Point',\r\n        enum: ['Point']\r\n      },\r\n      coordinates: [Number],\r\n      address: String,\r\n      description: String\r\n    },\r\n    maxGroupSize:Number,\r\n    locations: [\r\n      {\r\n        type: {\r\n          type: String,\r\n          default: 'Point',\r\n          enum: ['Point']\r\n        },\r\n        coordinates: [Number],\r\n        address: String,\r\n        description: String,\r\n        day: Number\r\n      }\r\n    ],\r\n    guides:[\r\n      {\r\n        type:mongoose.Schema.ObjectId,\r\n        ref:'User'\r\n      }\r\n    ]\r\n  },\r\n  {toJSON:{virtuals:true}},\r\n  {toObject:{virtuals:true}});\r\n\r\n\r\n  tourSchema.index({price:1,ratingsAverage:-1});\r\n  tourSchema.index({slug:1});\r\n  tourSchema.index({startLocation:'2dsphere'});\r\n  tourSchema.virtual('durationWeeks').get(function(){\r\n    return this.duration/7;\r\n  });\r\n\r\n  tourSchema.virtual('reviews',{\r\n    ref:'Review',\r\n    foreignField:'tour',\r\n    localField:'_id'\r\n  });\r\n\r\n  // DOCUMENT MIDDLEWARE: runs before .save() and .create()\r\ntourSchema.pre('save', function(next) {\r\n    this.slug = slugify(this.name, { lower: true });\r\n    next();\r\n  });\r\n  \r\n  // tourSchema.pre('save', function(next) {\r\n  //   console.log('Will save document...');\r\n  //   next();\r\n  // });\r\n  \r\n  // tourSchema.post('save', function(doc, next) {\r\n  //   console.log(doc);\r\n  //   next();\r\n  // });\r\n  \r\n  // QUERY MIDDLEWARE\r\n  // tourSchema.pre('find', function(next) {\r\n  tourSchema.pre(/^find/, function(next) {\r\n    this.find({ secretTour: { $ne: true } });\r\n  \r\n    this.start = Date.now();\r\n    next();\r\n  });\r\n  \r\n  tourSchema.post(/^find/, function(docs, next) {\r\n    console.log(`Query took ${Date.now() - this.start} milliseconds!`);\r\n    next();\r\n  });\r\n\r\n  tourSchema.pre(/^find/, function(next) {\r\n    this.populate({\r\n      path: 'guides',\r\n      select: '-__v -passwordChangedAt'\r\n    });\r\n  \r\n    next();\r\n  });\r\n  \r\n  // AGGREGATION MIDDLEWARE\r\n  // tourSchema.pre('aggregate', function(next) {\r\n  //   this.pipeline().unshift({ $match: { secretTour: { $ne: true } } });\r\n  \r\n  //   console.log(this.pipeline());\r\n  //   next();\r\n  // });\r\n  \r\n  const Tour=mongoose.model('Tour',tourSchema);\r\n\r\n  module.exports=Tour;"},"lineCount":null}},"error":null,"hash":"309df3f01f2ebc0c671a2217c43a48f5","cacheData":{"env":{}}}